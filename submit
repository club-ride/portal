<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Communications Plan ‚Äî Club Ride</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --cream: #F7F4EF;
    --ink: #1A1A18;
    --ink-light: #5A5A56;
    --accent: #1F417F;
    --accent-light: #EBF0F8;
    --border: #E0DAD0;
    --white: #FFFFFF;
    --success: #8DAA43;
    --section-bg: #FFFFFF;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--cream);
    color: var(--ink);
    min-height: 100vh;
  }

  /* Header */
  .header {
    background: var(--ink);
    color: var(--white);
    padding: 28px 48px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .header-left { display: flex; align-items: center; gap: 16px; }
  .logo {
    font-family: 'DM Sans', sans-serif;
    font-size: 22px;
    font-weight: 700;
    letter-spacing: -0.3px;
    color: var(--white);
  }
  .logo span { color: var(--accent); }
  .header-divider { width: 1px; height: 28px; background: rgba(255,255,255,0.2); }
  .header-title { font-size: 13px; font-weight: 400; color: rgba(255,255,255,0.6); letter-spacing: 0.5px; text-transform: uppercase; }
  .header-actions { display: flex; gap: 12px; }
  .btn {
    padding: 9px 20px;
    border-radius: 6px;
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    border: none;
    transition: all 0.15s;
  }
  .btn-ghost { background: rgba(255,255,255,0.1); color: var(--white); }
  .btn-ghost:hover { background: rgba(255,255,255,0.18); }
  .btn-primary { background: var(--accent); color: var(--white); }
  .btn-primary:hover { background: #17336a; }

  /* Layout */
  .layout { display: flex; min-height: calc(100vh - 73px); }

  /* Sidebar nav */
  .sidebar {
    width: 240px;
    flex-shrink: 0;
    background: var(--white);
    border-right: 1px solid var(--border);
    padding: 32px 0;
    position: sticky;
    top: 73px;
    height: calc(100vh - 73px);
    overflow-y: auto;
  }
  .sidebar-label {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 1.2px;
    text-transform: uppercase;
    color: var(--ink-light);
    padding: 0 24px 12px;
  }
  .nav-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 24px;
    font-size: 13px;
    font-weight: 400;
    color: var(--ink-light);
    cursor: pointer;
    transition: all 0.12s;
    border-left: 3px solid transparent;
    text-decoration: none;
  }
  .nav-item:hover { background: var(--cream); color: var(--ink); }
  .nav-item.active { color: var(--accent); border-left-color: var(--accent); background: var(--accent-light); font-weight: 500; }
  .nav-number {
    width: 20px; height: 20px;
    border-radius: 50%;
    background: var(--border);
    font-size: 10px;
    font-weight: 600;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    color: var(--ink-light);
  }
  .nav-item.active .nav-number { background: var(--accent); color: white; }
  .nav-item.complete .nav-number { background: var(--success); color: white; }
  .nav-item.complete { color: var(--ink); }

  /* Main content */
  .main { flex: 1; padding: 48px; max-width: 860px; }

  /* Section cards */
  .section-card {
    background: var(--section-bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 36px 40px;
    margin-bottom: 24px;
    display: none;
    animation: fadeUp 0.25s ease;
  }
  .section-card.active { display: block; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .section-header { margin-bottom: 28px; }
  .section-eyebrow {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 1.2px;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 6px;
  }
  .section-title {
    font-family: 'DM Sans', sans-serif;
    font-size: 26px;
    font-weight: 700;
    color: var(--ink);
    line-height: 1.2;
  }
  .section-desc { font-size: 13px; color: var(--ink-light); margin-top: 8px; line-height: 1.6; }

  /* Form elements */
  .field-group { margin-bottom: 20px; }
  .field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px; }
  .field-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 20px; }

  label {
    display: block;
    font-size: 12px;
    font-weight: 600;
    color: var(--ink);
    letter-spacing: 0.3px;
    margin-bottom: 6px;
  }
  label .optional { font-weight: 400; color: var(--ink-light); }

  input[type="text"], input[type="date"], input[type="time"], input[type="email"],
  select, textarea {
    width: 100%;
    padding: 10px 14px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    color: var(--ink);
    background: var(--cream);
    border: 1px solid var(--border);
    border-radius: 8px;
    outline: none;
    transition: border-color 0.15s, box-shadow 0.15s;
    -webkit-appearance: none;
  }
  input:focus, select:focus, textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(200, 82, 26, 0.1);
    background: var(--white);
  }
  textarea { resize: vertical; min-height: 90px; line-height: 1.6; }
  select { cursor: pointer; }

  /* Tag input */
  .tag-input-wrap {
    background: var(--cream);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    min-height: 44px;
    cursor: text;
    transition: border-color 0.15s, box-shadow 0.15s;
  }
  .tag-input-wrap:focus-within {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(200, 82, 26, 0.1);
    background: var(--white);
  }
  .tag {
    background: var(--ink);
    color: var(--white);
    border-radius: 4px;
    padding: 3px 8px;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .tag button { background: none; border: none; color: rgba(255,255,255,0.6); cursor: pointer; font-size: 14px; line-height: 1; padding: 0; }
  .tag button:hover { color: white; }
  .tag-input {
    border: none !important;
    background: transparent !important;
    outline: none;
    font-size: 13px;
    color: var(--ink);
    min-width: 120px;
    flex: 1;
    padding: 3px 4px !important;
    box-shadow: none !important;
  }

  /* Dynamic rows */
  .dynamic-table { width: 100%; border-collapse: collapse; }
  .dynamic-table th {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    color: var(--ink-light);
    padding: 0 10px 10px 0;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }
  .dynamic-table td { padding: 8px 8px 8px 0; vertical-align: top; }
  .dynamic-table td:last-child { width: 40px; text-align: center; padding-right: 0; }
  .dynamic-table input, .dynamic-table select, .dynamic-table textarea {
    margin: 0;
    font-size: 13px;
    padding: 8px 10px;
  }
  .row-delete {
    background: none;
    border: 1px solid var(--border);
    border-radius: 6px;
    width: 30px; height: 30px;
    cursor: pointer;
    color: var(--ink-light);
    font-size: 16px;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.12s;
    flex-shrink: 0;
  }
  .row-delete:hover { border-color: #e55; color: #e55; background: #fff0f0; }
  .add-row-btn {
    margin-top: 12px;
    background: none;
    border: 1px dashed var(--border);
    border-radius: 8px;
    padding: 9px 16px;
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    color: var(--ink-light);
    cursor: pointer;
    width: 100%;
    transition: all 0.12s;
    display: flex; align-items: center; justify-content: center; gap: 6px;
  }
  .add-row-btn:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-light); }

  /* Checkbox grid */
  .checkbox-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
  .checkbox-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 9px 12px;
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.12s;
    font-size: 13px;
  }
  .checkbox-item:hover { border-color: var(--accent); background: var(--accent-light); }
  .checkbox-item input[type="checkbox"] { width: 15px; height: 15px; accent-color: var(--accent); }
  .checkbox-item.checked { border-color: var(--accent); background: var(--accent-light); }

  /* File upload */
  .file-upload {
    border: 2px dashed var(--border);
    border-radius: 10px;
    padding: 32px;
    text-align: center;
    cursor: pointer;
    transition: all 0.15s;
    background: var(--cream);
  }
  .file-upload:hover { border-color: var(--accent); background: var(--accent-light); }
  .file-upload-icon { font-size: 32px; margin-bottom: 10px; }
  .file-upload-text { font-size: 14px; font-weight: 500; color: var(--ink); }
  .file-upload-sub { font-size: 12px; color: var(--ink-light); margin-top: 4px; }
  .file-upload input { display: none; }
  .file-list { margin-top: 12px; display: flex; flex-direction: column; gap: 6px; }
  .file-item {
    display: flex; align-items: center; justify-content: space-between;
    background: var(--white); border: 1px solid var(--border); border-radius: 6px;
    padding: 8px 12px; font-size: 13px;
  }
  .file-item-name { display: flex; align-items: center; gap: 8px; }
  .file-icon { font-size: 16px; }

  /* Phase headers */
  .phase-header {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 14px;
    letter-spacing: 0.2px;
  }
  .phase-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  /* Inline file upload */
  .inline-upload-btn {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 7px 12px;
    background: var(--cream);
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 12px;
    font-family: 'DM Sans', sans-serif;
    color: var(--ink-light);
    cursor: pointer;
    transition: all 0.12s;
    white-space: nowrap;
  }
  .inline-upload-btn:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-light); }
  .inline-file-name {
    display: block;
    font-size: 11px;
    color: var(--success);
    margin-top: 4px;
    word-break: break-all;
    max-width: 180px;
  }

  /* Divider */
  .divider { height: 1px; background: var(--border); margin: 28px 0; }

  /* Navigation buttons */
  .section-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 32px;
    padding-top: 24px;
    border-top: 1px solid var(--border);
  }
  .btn-nav {
    padding: 11px 28px;
    border-radius: 8px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    border: none;
    transition: all 0.15s;
  }
  .btn-back { background: var(--cream); color: var(--ink); border: 1px solid var(--border); }
  .btn-back:hover { background: var(--border); }
  .btn-next { background: var(--accent); color: var(--white); }
  .btn-next:hover { background: #B34515; }
  .btn-submit { background: var(--ink); color: var(--white); }
  .btn-submit:hover { background: #333; }

  /* Review screen */
  .review-section { margin-bottom: 28px; }
  .review-section-title {
    font-family: 'DM Sans', sans-serif;
    font-size: 18px;
    font-weight: 700;
    color: var(--ink);
    margin-bottom: 14px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
  }
  .review-edit-btn {
    font-size: 12px; color: var(--accent); cursor: pointer; font-family: 'DM Sans', sans-serif;
    font-weight: 500; background: none; border: none; padding: 0;
  }
  .review-field { margin-bottom: 10px; }
  .review-field-label { font-size: 11px; font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase; color: var(--ink-light); margin-bottom: 2px; }
  .review-field-value { font-size: 14px; color: var(--ink); line-height: 1.5; }

  /* Success */
  .success-screen {
    display: none;
    text-align: center;
    padding: 80px 40px;
  }
  .success-icon { font-size: 56px; margin-bottom: 20px; }
  .success-title { font-family: 'DM Sans', sans-serif; font-size: 36px; font-weight: 700; color: var(--ink); margin-bottom: 12px; }
  .success-sub { font-size: 15px; color: var(--ink-light); line-height: 1.6; max-width: 420px; margin: 0 auto 32px; }
  .success-link-box {
    background: var(--cream); border: 1px solid var(--border); border-radius: 10px;
    padding: 16px 20px; display: inline-flex; align-items: center; gap: 12px;
    font-size: 13px; color: var(--ink); max-width: 500px; width: 100%;
  }
  .success-link { flex: 1; text-align: left; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; color: var(--accent); }
  .copy-btn { flex-shrink: 0; background: var(--ink); color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; cursor: pointer; font-family: 'DM Sans', sans-serif; }

  /* Responsive */
  @media (max-width: 900px) {
    .sidebar { display: none; }
    .main { padding: 24px; }
    .field-row, .field-row-3 { grid-template-columns: 1fr; }
    .checkbox-grid { grid-template-columns: 1fr 1fr; }
    .header { padding: 20px 24px; }
  }
</style>
</head>
<body>

<header class="header">
  <div class="header-left">
    <div class="logo">Club<span>Ride</span></div>
    <div class="header-divider"></div>
    <div class="header-title">Communications Plan Submission</div>
  </div>
  <div class="header-actions">
    <button class="btn btn-ghost" onclick="saveDraft()">Save Draft</button>
    <button class="btn btn-primary" onclick="goToSection(12)">Review & Submit</button>
  </div>
</header>

<div class="layout">

  <!-- Sidebar -->
  <nav class="sidebar">
    <div class="sidebar-label">Sections</div>
    <a class="nav-item active" onclick="goToSection(1)" id="nav-1">
      <span class="nav-number">1</span> Overview
    </a>
    <a class="nav-item" onclick="goToSection(2)" id="nav-2">
      <span class="nav-number">2</span> Key Event Details
    </a>
    <a class="nav-item" onclick="goToSection(3)" id="nav-3">
      <span class="nav-number">3</span> Roles & Responsibilities
    </a>
    <a class="nav-item" onclick="goToSection(4)" id="nav-4">
      <span class="nav-number">4</span> Objectives
    </a>
    <a class="nav-item" onclick="goToSection(5)" id="nav-5">
      <span class="nav-number">5</span> Goals
    </a>
    <a class="nav-item" onclick="goToSection(6)" id="nav-6">
      <span class="nav-number">6</span> Target Audience
    </a>
    <a class="nav-item" onclick="goToSection(7)" id="nav-7">
      <span class="nav-number">7</span> Marketing Strategy
    </a>
    <a class="nav-item" onclick="goToSection(8)" id="nav-8">
      <span class="nav-number">8</span> Tactics
    </a>
    <a class="nav-item" onclick="goToSection(9)" id="nav-9">
      <span class="nav-number">9</span> Creative Specs
    </a>
    <a class="nav-item" onclick="goToSection(10)" id="nav-10">
      <span class="nav-number">10</span> Attachments
    </a>
    <a class="nav-item" onclick="goToSection(11)" id="nav-11">
      <span class="nav-number">11</span> Workback Calendar
    </a>
    <a class="nav-item" onclick="goToSection(12)" id="nav-12">
      <span class="nav-number">12</span> Comms Calendar
    </a>
  </nav>

  <!-- Main -->
  <main class="main">

    <!-- SECTION 1: Overview -->
    <div class="section-card active" id="section-1">
      <div class="section-header">
        <div class="section-eyebrow">Section 1</div>
        <div class="section-title">Overview</div>
        <div class="section-desc">Provide a brief description of the event or campaign and its purpose.</div>
      </div>
      <div class="field-row">
        <div class="field-group">
          <label>Event / Campaign Name</label>
          <input type="text" id="event-name" placeholder="e.g. Women's History Month Community Bike Ride">
        </div>
        <div class="field-group">
          <label>Short Name <span class="optional">(for naming conventions)</span></label>
          <input type="text" id="event-short-name" placeholder="e.g. WHM2026">
        </div>
      </div>
      <div class="field-group">
        <label>Overview <span class="optional">(2‚Äì4 sentences)</span></label>
        <textarea id="overview" rows="5" placeholder="Describe what this event or campaign is, who it's for, and what it aims to accomplish..."></textarea>
      </div>
      <div class="field-group">
        <label>Theme / Central Message <span class="optional">(optional)</span></label>
        <input type="text" id="theme" placeholder="e.g. Honoring women who shaped Southern Nevada through movement and storytelling">
      </div>
      <div class="section-footer">
        <span></span>
        <button class="btn-nav btn-next" onclick="nextSection(1)">Next: Key Event Details ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 2: Key Event Details -->
    <div class="section-card" id="section-2">
      <div class="section-header">
        <div class="section-eyebrow">Section 2</div>
        <div class="section-title">Key Event Details</div>
        <div class="section-desc">Provide the core logistics for this event.</div>
      </div>
      <div class="field-row">
        <div>
          <label>Event Date</label>
          <input type="date" id="event-date">
        </div>
        <div>
          <label>Event Day <span class="optional">(auto-fills)</span></label>
          <input type="text" id="event-day" placeholder="e.g. Saturday" readonly style="background:#eee">
        </div>
      </div>
      <div class="field-row">
        <div>
          <label>Start Time</label>
          <input type="time" id="event-start">
        </div>
        <div>
          <label>End Time <span class="optional">(approx.)</span></label>
          <input type="time" id="event-end">
        </div>
      </div>
      <div class="field-group">
        <label>Location / Venue</label>
        <input type="text" id="event-location" placeholder="e.g. Carolyn G. Goodman Plaza, 525 S Main St, Las Vegas, NV">
      </div>
      <div class="field-group">
        <label>Additional Notes <span class="optional">(optional)</span></label>
        <textarea id="event-notes" rows="3" placeholder="Any other logistical details reviewers should know..."></textarea>
      </div>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(2)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(2)">Next: Roles & Responsibilities ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 3: Roles & Responsibilities -->
    <div class="section-card" id="section-3">
      <div class="section-header">
        <div class="section-eyebrow">Section 3</div>
        <div class="section-title">Roles & Responsibilities</div>
        <div class="section-desc">List all team members and partners involved, along with their roles.</div>
      </div>

      <label style="margin-bottom:12px; display:block;">Team Members & Partners</label>
      <table class="dynamic-table" id="roles-table">
        <thead>
          <tr>
            <th style="width:20%">Name</th>
            <th style="width:20%">Role / Title</th>
            <th style="width:20%">Team / Org</th>
            <th>Responsibilities</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="roles-cr-body">
          <tr>
            <td><input type="text" placeholder="Name"></td>
            <td><input type="text" placeholder="Role"></td>
            <td><input type="text" placeholder="e.g. Club Ride, RTC"></td>
            <td><input type="text" placeholder="Responsibilities"></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('roles-cr-body', rolesRowTemplate)">+ Add team member or partner</button>

      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(3)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(3)">Next: Objectives ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 4: Objectives -->
    <div class="section-card" id="section-4">
      <div class="section-header">
        <div class="section-eyebrow">Section 4</div>
        <div class="section-title">Objectives</div>
        <div class="section-desc">List the qualitative outcomes this event or campaign is designed to achieve.</div>
      </div>
      <div id="objectives-list">
        <div class="field-row" style="grid-template-columns: 1fr 40px; margin-bottom:10px;" id="obj-row-0">
          <input type="text" placeholder="e.g. Educate participants on the history of women's mobility in Nevada">
          <button class="row-delete" onclick="deleteObjectiveRow(this)">√ó</button>
        </div>
      </div>
      <button class="add-row-btn" onclick="addObjectiveRow()">+ Add objective</button>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(4)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(4)">Next: Goals ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 5: Goals -->
    <div class="section-card" id="section-5">
      <div class="section-header">
        <div class="section-eyebrow">Section 5</div>
        <div class="section-title">Goals</div>
        <div class="section-desc">List specific, measurable targets for this event or campaign.</div>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th>Goal Description</th>
            <th style="width:160px">Target / Metric</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="goals-body">
          <tr>
            <td><input type="text" placeholder="e.g. Registered participants"></td>
            <td><input type="text" placeholder="e.g. 30"></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
          <tr>
            <td><input type="text" placeholder="e.g. Riders tracking trip in app"></td>
            <td><input type="text" placeholder="e.g. 60%"></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('goals-body', goalsRowTemplate)">+ Add goal</button>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(5)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(5)">Next: Target Audience ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 6: Target Audience -->
    <div class="section-card" id="section-6">
      <div class="section-header">
        <div class="section-eyebrow">Section 6</div>
        <div class="section-title">Target Audience</div>
        <div class="section-desc">Select all audience segments this campaign is intended to reach.</div>
      </div>
      <label style="margin-bottom:12px; display:block;">Audience Segments</label>
      <div class="checkbox-grid" id="audience-grid">
        <label class="checkbox-item"><input type="checkbox" value="General Public"> General Public</label>
        <label class="checkbox-item"><input type="checkbox" value="Bicycle Enthusiasts"> Bicycle Enthusiasts</label>
        <label class="checkbox-item"><input type="checkbox" value="Bike Share Pass-holders"> Bike Share Pass-holders</label>
        <label class="checkbox-item"><input type="checkbox" value="Club Ride Members"> Club Ride Members</label>
        <label class="checkbox-item"><input type="checkbox" value="Advocacy Groups"> Advocacy Groups</label>
        <label class="checkbox-item"><input type="checkbox" value="RTC Employees"> RTC Employees</label>
        <label class="checkbox-item"><input type="checkbox" value="Community Partners"> Community Partners</label>
        <label class="checkbox-item"><input type="checkbox" value="Media / Press"> Media / Press</label>
        <label class="checkbox-item"><input type="checkbox" value="Other"> Other</label>
      </div>
      <div class="field-group" style="margin-top:20px;">
        <label>Additional Audience Notes <span class="optional">(optional)</span></label>
        <textarea id="audience-notes" rows="3" placeholder="Any nuances about the target audience or reach strategy..."></textarea>
      </div>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(6)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(6)">Next: Marketing Strategy ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 7: Marketing Strategy -->
    <div class="section-card" id="section-7">
      <div class="section-header">
        <div class="section-eyebrow">Section 7</div>
        <div class="section-title">Marketing Strategy</div>
        <div class="section-desc">Outline the key messages and strategic approach for this campaign.</div>
      </div>
      <div class="field-group">
        <label>Key Messages</label>
        <div id="messages-list">
          <div style="display:grid; grid-template-columns: 1fr 40px; gap:8px; margin-bottom:8px;">
            <textarea rows="2" placeholder="Key message #1..."></textarea>
            <div style="padding-top:8px;"><button class="row-delete" onclick="this.closest('div').parentElement.remove()">√ó</button></div>
          </div>
        </div>
        <button class="add-row-btn" onclick="addMessageRow()">+ Add key message</button>
      </div>
      <div class="divider"></div>
      <div class="field-group">
        <label>Strategic Approach / Notes <span class="optional">(optional)</span></label>
        <textarea id="strategy-notes" rows="4" placeholder="Describe any broader strategic framing, tone, or approach for the campaign..."></textarea>
      </div>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(7)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(7)">Next: Tactics ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 8: Tactics -->
    <div class="section-card" id="section-8">
      <div class="section-header">
        <div class="section-eyebrow">Section 8</div>
        <div class="section-title">Tactics</div>
        <div class="section-desc">Select all channels and tactics that will be used for this campaign.</div>
      </div>
      <label style="margin-bottom:12px; display:block;">Channels & Tactics</label>
      <div class="checkbox-grid">
        <label class="checkbox-item"><input type="checkbox"> Club Ride Newsletter</label>
        <label class="checkbox-item"><input type="checkbox"> RTC Blog & Website</label>
        <label class="checkbox-item"><input type="checkbox"> Blink Post</label>
        <label class="checkbox-item"><input type="checkbox"> Wi-Fi Signage</label>
        <label class="checkbox-item"><input type="checkbox"> In-App Messaging</label>
        <label class="checkbox-item"><input type="checkbox"> BTC & SSTT Monitors</label>
        <label class="checkbox-item"><input type="checkbox"> Instagram</label>
        <label class="checkbox-item"><input type="checkbox"> Facebook</label>
        <label class="checkbox-item"><input type="checkbox"> LinkedIn</label>
        <label class="checkbox-item"><input type="checkbox"> YouTube</label>
        <label class="checkbox-item"><input type="checkbox"> Partner Outreach</label>
        <label class="checkbox-item"><input type="checkbox"> Email / Eblast</label>
        <label class="checkbox-item"><input type="checkbox"> Flyers / Print</label>
        <label class="checkbox-item"><input type="checkbox"> Press / Media</label>
        <label class="checkbox-item"><input type="checkbox"> Other</label>
      </div>
      <div class="field-group" style="margin-top:20px;">
        <label>Additional Tactic Notes <span class="optional">(optional)</span></label>
        <textarea id="tactics-notes" rows="3" placeholder="Any specific details about how these tactics will be used..."></textarea>
      </div>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(8)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(8)">Next: Creative Specs ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 9: Creative Specs -->
    <div class="section-card" id="section-9">
      <div class="section-header">
        <div class="section-eyebrow">Section 9</div>
        <div class="section-title">Creative Specs</div>
        <div class="section-desc">List the creative assets needed and their specifications.</div>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th>Asset Type</th>
            <th style="width:180px">Dimensions / Specs</th>
            <th style="width:130px">Format</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="specs-body">
          <tr>
            <td><input type="text" placeholder="e.g. Landing Page Hero"></td>
            <td><input type="text" placeholder="e.g. 1600 √ó 600 px"></td>
            <td>
              <select>
                <option value="">Format</option>
                <option>JPG</option>
                <option>PNG</option>
                <option>SVG</option>
                <option>PDF</option>
                <option>GIF</option>
                <option>MP4</option>
                <option>Other</option>
              </select>
            </td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
          <tr>
            <td><input type="text" placeholder="e.g. Social Media (IG/FB)"></td>
            <td><input type="text" placeholder="e.g. 1080 √ó 1350 px"></td>
            <td>
              <select>
                <option value="">Format</option>
                <option>JPG</option>
                <option>PNG</option>
                <option>SVG</option>
                <option>PDF</option>
                <option>GIF</option>
                <option>MP4</option>
                <option>Other</option>
              </select>
            </td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('specs-body', specsRowTemplate)">+ Add creative asset</button>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(9)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(9)">Next: Creative Attachments ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 10: Attachments -->
    <div class="section-card" id="section-10">
      <div class="section-header">
        <div class="section-eyebrow">Section 10</div>
        <div class="section-title">Attachments</div>
        <div class="section-desc">List any creative assets, mockups, or reference files included with this plan.</div>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th>Asset Name</th>
            <th style="width:25%">Asset Type</th>
            <th style="width:200px">File Upload</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="attachments-body">
          <tr>
            <td><input type="text" placeholder="e.g. WHM Landing Page Hero v1"></td>
            <td>
              <select>
                <option value="">Type</option>
                <option>Mockup</option>
                <option>Logo</option>
                <option>Photography</option>
                <option>Video</option>
                <option>Copy / Script</option>
                <option>Flyer / Print</option>
                <option>Presentation</option>
                <option>Spreadsheet</option>
                <option>Other</option>
              </select>
            </td>
            <td><label class="inline-upload-btn">üìé Choose file<input type="file" style="display:none" onchange="showInlineFile(this)"></label><span class="inline-file-name"></span></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('attachments-body', attachmentsRowTemplate)">+ Add attachment</button>
      <div class="field-group" style="margin-top:20px;">
        <label>Notes on Attachments <span class="optional">(optional)</span></label>
        <textarea id="attachment-notes" rows="3" placeholder="Any context about the files listed, what stage they're at, or what feedback is needed..."></textarea>
      </div>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(10)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(10)">Next: Workback Calendar ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 11: Workback Calendar -->
    <div class="section-card" id="section-11">
      <div class="section-header">
        <div class="section-eyebrow">Section 11</div>
        <div class="section-title">Workback Calendar</div>
        <div class="section-desc">List key tasks by phase ‚Äî approval, execution, and post-event.</div>
      </div>

      <!-- Phase 1: Approval -->
      <div class="phase-header">
        <div class="phase-dot" style="background:#1F417F"></div>
        <span>Phase 1 ‚Äî Approval</span>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th>Task / Item</th>
            <th style="width:130px">Deadline</th>
            <th style="width:130px">Owner</th>
            <th style="width:120px">Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="workback-approval-body">
          <tr>
            <td><input type="text" placeholder="Task description"></td>
            <td><input type="date"></td>
            <td><input type="text" placeholder="Owner"></td>
            <td><select><option value="">Status</option><option>Not Started</option><option>In Progress</option><option>Complete</option><option>Blocked</option></select></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('workback-approval-body', workbackRowTemplate)">+ Add approval task</button>

      <div class="divider"></div>

      <!-- Phase 2: Execution -->
      <div class="phase-header">
        <div class="phase-dot" style="background:#8DAA43"></div>
        <span>Phase 2 ‚Äî Execution</span>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th>Task / Item</th>
            <th style="width:130px">Deadline</th>
            <th style="width:130px">Owner</th>
            <th style="width:120px">Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="workback-execution-body">
          <tr>
            <td><input type="text" placeholder="Task description"></td>
            <td><input type="date"></td>
            <td><input type="text" placeholder="Owner"></td>
            <td><select><option value="">Status</option><option>Not Started</option><option>In Progress</option><option>Complete</option><option>Blocked</option></select></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('workback-execution-body', workbackRowTemplate)">+ Add execution task</button>

      <div class="divider"></div>

      <!-- Phase 3: Post-Event -->
      <div class="phase-header">
        <div class="phase-dot" style="background:#5A5A56"></div>
        <span>Phase 3 ‚Äî Post-Event</span>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th>Task / Item</th>
            <th style="width:130px">Deadline</th>
            <th style="width:130px">Owner</th>
            <th style="width:120px">Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="workback-postevent-body">
          <tr>
            <td><input type="text" placeholder="Task description"></td>
            <td><input type="date"></td>
            <td><input type="text" placeholder="Owner"></td>
            <td><select><option value="">Status</option><option>Not Started</option><option>In Progress</option><option>Complete</option><option>Blocked</option></select></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('workback-postevent-body', workbackRowTemplate)">+ Add post-event task</button>

      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(11)">‚Üê Back</button>
        <button class="btn-nav btn-next" onclick="nextSection(11)">Next: Comms Calendar ‚Üí</button>
      </div>
    </div>

    <!-- SECTION 12: Communications Calendar -->
    <div class="section-card" id="section-12">
      <div class="section-header">
        <div class="section-eyebrow">Section 12</div>
        <div class="section-title">Communications Calendar</div>
        <div class="section-desc">Map out the planned publish dates, channels, content details, and owners.</div>
      </div>
      <table class="dynamic-table">
        <thead>
          <tr>
            <th style="width:120px">Publish Date</th>
            <th style="width:160px">Channel</th>
            <th>Content Detail</th>
            <th style="width:110px">Owner</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="comms-body">
          <tr>
            <td><input type="date"></td>
            <td>
              <select>
                <option value="">Channel</option>
                <option>Web / Blog</option>
                <option>Instagram</option>
                <option>Facebook</option>
                <option>LinkedIn</option>
                <option>YouTube</option>
                <option>Email / Eblast</option>
                <option>In-App</option>
                <option>BTC / SSTT</option>
                <option>Wi-Fi Signage</option>
                <option>Newsletter</option>
                <option>Blink Post</option>
                <option>Other</option>
              </select>
            </td>
            <td><input type="text" placeholder="Brief description of content"></td>
            <td><input type="text" placeholder="Owner"></td>
            <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
          </tr>
        </tbody>
      </table>
      <button class="add-row-btn" onclick="addRow('comms-body', commsRowTemplate)">+ Add content item</button>
      <div class="section-footer">
        <button class="btn-nav btn-back" onclick="prevSection(12)">‚Üê Back</button>
        <button class="btn-nav btn-submit" onclick="submitPlan()">Submit for Review ‚Üí</button>
      </div>
    </div>

    <!-- Success Screen -->
    <div class="success-screen" id="success-screen">
      <div class="success-icon">‚úÖ</div>
      <div class="success-title">Plan Submitted!</div>
      <div class="success-sub">Your communications plan has been submitted for internal review. Share the link below with your reviewer when ready.</div>
      <div class="success-link-box">
        <span class="success-link" id="share-link">https://clubride.app/review/WHM-2026-commsplan</span>
        <button class="copy-btn" onclick="copyLink()">Copy</button>
      </div>
      <p style="font-size:12px; color:var(--ink-light); margin-top:16px;">The reviewer can open this link directly from email ‚Äî no login required.</p>
    </div>

  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  // ‚îÄ‚îÄ Supabase config ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const SUPABASE_URL = 'https://bcvwfthrqfzmfwzauhrl.supabase.co';
  const SUPABASE_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJjdndmdGhycWZ6bWZ3emF1aHJsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1NDE2MDMsImV4cCI6MjA4NzExNzYwM30.kC0SQw_6fev9V-KgJfuYaUdHrrlDUc7CLRfEPXig0eo';
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

  // ‚îÄ‚îÄ Navigation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  let currentSection = 1;
  const totalSections = 12;

  function goToSection(n) {
    document.getElementById('section-' + currentSection).classList.remove('active');
    document.getElementById('nav-' + currentSection).classList.remove('active');
    document.getElementById('nav-' + currentSection).classList.add('complete');
    currentSection = n;
    document.getElementById('section-' + n).classList.add('active');
    document.getElementById('nav-' + n).classList.add('active');
    document.getElementById('nav-' + n).classList.remove('complete');
    window.scrollTo({top: 0, behavior: 'smooth'});
  }

  function nextSection(n) { if (n < totalSections) goToSection(n + 1); }
  function prevSection(n) { if (n > 1) goToSection(n - 1); }

  // ‚îÄ‚îÄ Auto-fill day of week ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  document.getElementById('event-date').addEventListener('change', function() {
    if (this.value) {
      const days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
      const d = new Date(this.value + 'T12:00:00');
      document.getElementById('event-day').value = days[d.getDay()];
    }
  });

  // ‚îÄ‚îÄ Row helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function deleteRow(btn) {
    const row = btn.closest('tr');
    if (row.parentElement.children.length > 1) row.remove();
  }
  function addRow(tbodyId, templateFn) {
    document.getElementById(tbodyId).insertAdjacentHTML('beforeend', templateFn());
  }

  // ‚îÄ‚îÄ Row templates ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const rolesRowTemplate = () => `<tr>
    <td><input type="text" placeholder="Name"></td>
    <td><input type="text" placeholder="Role"></td>
    <td><input type="text" placeholder="e.g. Club Ride, RTC"></td>
    <td><input type="text" placeholder="Responsibilities"></td>
    <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
  </tr>`;

  const goalsRowTemplate = () => `<tr>
    <td><input type="text" placeholder="Goal description"></td>
    <td><input type="text" placeholder="Target / Metric"></td>
    <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
  </tr>`;

  const attachmentsRowTemplate = () => `<tr>
    <td><input type="text" placeholder="e.g. WHM Landing Page Hero v1"></td>
    <td><select><option value="">Type</option><option>Mockup</option><option>Logo</option><option>Photography</option><option>Video</option><option>Copy / Script</option><option>Flyer / Print</option><option>Presentation</option><option>Spreadsheet</option><option>Other</option></select></td>
    <td><label class="inline-upload-btn">üìé Choose file<input type="file" style="display:none" onchange="showInlineFile(this)"></label><span class="inline-file-name"></span></td>
    <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
  </tr>`;

  const specsRowTemplate = () => `<tr>
    <td><input type="text" placeholder="e.g. Eblast Header"></td>
    <td><input type="text" placeholder="e.g. 800px wide"></td>
    <td><select><option value="">Format</option><option>JPG</option><option>PNG</option><option>SVG</option><option>PDF</option><option>GIF</option><option>MP4</option><option>Other</option></select></td>
    <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
  </tr>`;

  const workbackRowTemplate = () => `<tr>
    <td><input type="text" placeholder="Task description"></td>
    <td><input type="date"></td>
    <td><input type="text" placeholder="Owner"></td>
    <td><select><option value="">Status</option><option>Not Started</option><option>In Progress</option><option>Complete</option><option>Blocked</option></select></td>
    <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
  </tr>`;

  const commsRowTemplate = () => `<tr>
    <td><input type="date"></td>
    <td><select><option value="">Channel</option><option>Web / Blog</option><option>Instagram</option><option>Facebook</option><option>LinkedIn</option><option>YouTube</option><option>Email / Eblast</option><option>In-App</option><option>BTC / SSTT</option><option>Wi-Fi Signage</option><option>Newsletter</option><option>Blink Post</option><option>Other</option></select></td>
    <td><input type="text" placeholder="Brief description of content"></td>
    <td><input type="text" placeholder="Owner"></td>
    <td><button class="row-delete" onclick="deleteRow(this)">√ó</button></td>
  </tr>`;

  // ‚îÄ‚îÄ Objectives ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  let objCount = 1;
  function addObjectiveRow() {
    const id = 'obj-row-' + objCount++;
    document.getElementById('objectives-list').insertAdjacentHTML('beforeend',
      `<div style="display:grid; grid-template-columns: 1fr 40px; gap:8px; margin-bottom:8px;" id="${id}">
        <input type="text" placeholder="Objective...">
        <button class="row-delete" onclick="deleteObjectiveRow(this)">√ó</button>
      </div>`);
  }
  function deleteObjectiveRow(btn) {
    const row = btn.closest('div[id]');
    if (document.getElementById('objectives-list').children.length > 1) row.remove();
  }

  // ‚îÄ‚îÄ Key messages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function addMessageRow() {
    document.getElementById('messages-list').insertAdjacentHTML('beforeend',
      `<div style="display:grid; grid-template-columns: 1fr 40px; gap:8px; margin-bottom:8px;">
        <textarea rows="2" placeholder="Key message..."></textarea>
        <div style="padding-top:8px;"><button class="row-delete" onclick="this.closest('div').parentElement.remove()">√ó</button></div>
      </div>`);
  }

  // ‚îÄ‚îÄ Inline file display ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function showInlineFile(input) {
    const span = input.closest('td').querySelector('.inline-file-name');
    if (input.files && input.files[0]) span.textContent = '‚úì ' + input.files[0].name;
  }

  // ‚îÄ‚îÄ Checkbox toggle ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(cb => {
    cb.addEventListener('change', function() {
      this.closest('.checkbox-item').classList.toggle('checked', this.checked);
    });
  });

  // ‚îÄ‚îÄ Collect all form data into a JSON object ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function collectFormData() {
    const tableRows = (tbodyId) => Array.from(document.getElementById(tbodyId)?.rows || []).map(r =>
      Array.from(r.cells).slice(0, -1).map(c => {
        const el = c.querySelector('input,select,textarea');
        return el ? el.value : '';
      })
    );

    const checkboxValues = (gridSelector) =>
      Array.from(document.querySelectorAll(`${gridSelector} input[type="checkbox"]:checked`)).map(c => c.value || c.closest('.checkbox-item').textContent.trim());

    const objectives = Array.from(document.querySelectorAll('#objectives-list input[type="text"]')).map(i => i.value).filter(Boolean);
    const keyMessages = Array.from(document.querySelectorAll('#messages-list textarea')).map(t => t.value).filter(Boolean);

    return {
      overview: {
        event_name: document.getElementById('event-name')?.value || '',
        short_name: document.getElementById('event-short-name')?.value || '',
        overview: document.getElementById('overview')?.value || '',
        theme: document.getElementById('theme')?.value || '',
      },
      event_details: {
        date: document.getElementById('event-date')?.value || '',
        day: document.getElementById('event-day')?.value || '',
        start_time: document.getElementById('event-start')?.value || '',
        end_time: document.getElementById('event-end')?.value || '',
        location: document.getElementById('event-location')?.value || '',
        notes: document.getElementById('event-notes')?.value || '',
      },
      roles: tableRows('roles-cr-body'),
      objectives,
      goals: tableRows('goals-body'),
      target_audience: {
        segments: checkboxValues('#audience-grid'),
        notes: document.getElementById('audience-notes')?.value || '',
      },
      marketing_strategy: {
        key_messages: keyMessages,
        notes: document.getElementById('strategy-notes')?.value || '',
      },
      tactics: {
        channels: Array.from(document.querySelectorAll('#section-8 .checkbox-item input[type="checkbox"]:checked')).map(c => c.closest('.checkbox-item').textContent.trim()),
        notes: document.getElementById('tactics-notes')?.value || '',
      },
      creative_specs: tableRows('specs-body'),
      attachments: tableRows('attachments-body'),
      workback: {
        approval: tableRows('workback-approval-body'),
        execution: tableRows('workback-execution-body'),
        post_event: tableRows('workback-postevent-body'),
      },
      comms_calendar: tableRows('comms-body'),
    };
  }

  // ‚îÄ‚îÄ Upload all attached files to Supabase Storage ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  async function uploadAttachmentFiles(submissionId) {
    const rows = document.getElementById('attachments-body')?.rows || [];
    const uploaded = [];
    for (let i = 0; i < rows.length; i++) {
      const fileInput = rows[i].querySelector('input[type="file"]');
      if (fileInput && fileInput.files[0]) {
        const file = fileInput.files[0];
        const path = `${submissionId}/${Date.now()}_${file.name.replace(/\s+/g, '_')}`;
        const { error } = await sb.storage.from('attachments').upload(path, file);
        if (!error) {
          const { data: urlData } = sb.storage.from('attachments').getPublicUrl(path);
          uploaded.push({ name: file.name, url: urlData.publicUrl, path });
        }
      }
    }
    return uploaded;
  }

  // ‚îÄ‚îÄ Save Draft ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  async function saveDraft() {
    const btn = document.querySelector('.btn-ghost');
    btn.textContent = 'Saving‚Ä¶';
    btn.disabled = true;

    const formData = collectFormData();
    const eventName = formData.overview.event_name || 'Untitled Draft';
    const shortName = formData.overview.short_name || '';

    try {
      const { error } = await sb.from('submissions').insert({
        event_name: eventName,
        short_name: shortName,
        form_data: formData,
        status: 'draft',
      });
      if (error) throw error;
      btn.textContent = 'Draft Saved ‚úì';
    } catch (e) {
      console.error(e);
      btn.textContent = 'Save Failed';
    } finally {
      btn.disabled = false;
      setTimeout(() => btn.textContent = 'Save Draft', 2500);
    }
  }

  // ‚îÄ‚îÄ Submit Plan ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  async function submitPlan() {
    const submitBtn = document.querySelector('.btn-submit');
    submitBtn.textContent = 'Submitting‚Ä¶';
    submitBtn.disabled = true;

    const formData = collectFormData();
    const eventName = formData.overview.event_name || 'Untitled Plan';
    const shortName = formData.overview.short_name || '';

    try {
      // 1. Insert submission row
      const { data, error } = await sb.from('submissions').insert({
        event_name: eventName,
        short_name: shortName,
        form_data: formData,
        status: 'pending',
      }).select('id').single();

      if (error) throw error;
      const submissionId = data.id;

      // 2. Upload files and attach their URLs
      const uploadedFiles = await uploadAttachmentFiles(submissionId);
      if (uploadedFiles.length > 0) {
        await sb.from('submissions').update({
          form_data: { ...formData, uploaded_files: uploadedFiles }
        }).eq('id', submissionId);
      }

      // 3. Build review link using submission ID
      const reviewLink = `${window.location.origin}${window.location.pathname}?review=${submissionId}`;

      // 4. Show success screen
      document.getElementById('section-12').classList.remove('active');
      document.getElementById('nav-12').classList.remove('active');
      document.getElementById('nav-12').classList.add('complete');
      document.getElementById('share-link').textContent = reviewLink;
      document.getElementById('success-screen').style.display = 'block';
      window.scrollTo({top: 0, behavior: 'smooth'});

    } catch (e) {
      console.error('Submission error:', e);
      alert('Something went wrong submitting the plan. Please try again.\n\n' + (e.message || e));
      submitBtn.textContent = 'Submit for Review ‚Üí';
      submitBtn.disabled = false;
    }
  }

  // ‚îÄ‚îÄ Copy link ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function copyLink() {
    navigator.clipboard.writeText(document.getElementById('share-link').textContent);
    document.querySelector('.copy-btn').textContent = 'Copied!';
    setTimeout(() => document.querySelector('.copy-btn').textContent = 'Copy', 2000);
  }
</script>
</body>
</html>
